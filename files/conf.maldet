#!/bin/bash
#
##
# Linux Malware Detect v1.5
#             (C) 2002-2012, R-fx Networks <proj@r-fx.org>
#             (C) 2012, Ryan MacDonald <ryan@r-fx.org>
# This program may be freely redistributed under the terms of the GNU GPL v2
##
#

##
# [ EMAIL ALERTS ]
##
# Enable or disable e-mai alert system
# [0 = disabled, 1 = enabled]
email_alert=0

# The subject line for e-mail alerts
email_subj="maldet alert from $(hostname)"

# The destination addresses for e-mail alerts
# [ values are comma (,) spaced ]
email_addr="you@domain.com"

# Ignore e-mail alerts for reports in which all hits have been cleaned
# [0 = disabled, 1 = enabled]
email_ignore_clean=0

##
# [ QUARANTINE OPTIONS ]
##
# The default quarantine action for malware hits
# [0 = alert only, 1 = move to quarantine & alert]
quarantine_hits=0

# Try to clean string based malware injections
# [NOTE: quarantine_hits=1 required]
# [0 = disabled, 1 = clean]
quarantine_clean=1

# The default suspend action for users wih hits
# Cpanel suspend or set shell /bin/false on non-Cpanel
# [NOTE: quarantine_hits=1 required]
# [0 = disabled, 1 = suspend account]
quarantine_suspend_user=0

# The minimum userid value that can be suspended
# [ default = 500 ]
quarantine_suspend_user_minuid=500

##
# [ ADVANCED SCAN OPTIONS ]
##

# The maximum directory depth that the scanner will search
# [ changing this may have an impact on scan performance ]
scan_find_max_depth=15

# The minimum in bytes for a file to be included in a scan
# [ changing this may have an impact on scan performance ]
scan_find_min_filesize=32

# The maximum file size for a file to be included in scan
# search results; use man find for accepted values
# [ changing this may have an impact on scan performance ]
scan_find_max_filesize="768k"

# The maximum byte depth that the scanner will search into
# a files contents; default rules expect a 1024*60 depth
# [ changing this may have an impact on scan performance ]
scan_hexdepth=61440

# Use named pipe (FIFO) for passing file contents hex data
# instead of stdin default; improved performance and greater
# scanning depth
# [ 0 = disabled, 1 = enabled; enabled by default ] 
scan_hexfifo=1

# The maximum byte depth that the scanner will search into
# a files contents; default rules expect a 1024*60 depth
# [ changing this may have an impact on scan performance ]
scan_hexfifo_depth=524288

# If installed, use ClamAV clamscan binary as default scan
# engine which providers a higher degree of performance.
# This option only uses ClamAV as the scanner engine, LMD
# signatures are still the basis for detecting threats.
# [ 0 = disabled, 1 = enabled; enabled by default ] 
scan_clamscan=1

# Include the scanning of known temporary world-writable
# paths for -a|--al and -r|--recent scan types.
scan_tmpdir_paths="/tmp /var/tmp /dev/shm"

# Allow non-root users to perform malware scans. This must be
# enabled when using mod_security2 upload scanning or if you
# want to allow users to perform scans. When enabled, this will
# populate the /usr/local/maldetect/pub/ path with user owned
# quarantine, session and temporary paths to faciliate scans.
# These paths are populated through cron every 10min with the
# /etc/cron.d/maldet_pub cronjob.
# [ 0 = disabled, 1 = enabled, disabled by defaukt ] 
scan_user_access=0

# Process CPU scheduling (nice) priority level for scan operations.
# [ -19 = high prio , 19 = low prio, default = 19 ]
scan_cpunice="19"

##
# [ STATISTICAL ANALYSIS ]
##
# The string length test is used to identify threats based on the
# length of the longest uninterrupted string within a file. This is
# useful as obfuscated code is often stored using encoding methods
# that produce very long strings without spaces (e.g: base64)
# [ string length in characters, default = 150000 ]
string_length_scan="0"		# [ 0 = disabled, 1 = enabled ]
string_length="150000"		# [ max string length ]

##
# [ MONITORING OPTIONS ]
##
# The base number of files that can be watched under a path
# [ maximum file watches = inotify_base_watches*users ]
inotify_base_watches=131072

# The sleep time in seconds between monitor runs to scan files
# that have been created/modified/moved
inotify_sleep=30

# The minimum userid that will be added to path monitoring when
# the USERS option is specified
inotify_minuid=500

# This is the html/web root for users relative to homedir, when
# this option is set, users will only have the webdir monitored
# [ clear option to default monitor entire user homedir ]
inotify_docroot=public_html

# Process CPU scheduling (nice) priority level for monitoring process.
# [ -19 = high prio , 19 = low prio, default = 15 ]
inotify_cpunice=15
